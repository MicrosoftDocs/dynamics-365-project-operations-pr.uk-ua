---
title: Налаштування автоматичного створення рахунків – легка версія
description: У цій темі описується, як налаштувати автоматичне створення рахунків-проформ.
author: rumant
manager: Annbe
ms.date: 10/13/2020
ms.topic: article
ms.service: project-operations
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: 1d911ab0defaaee40d8752557e1115ea49c8fa93
ms.sourcegitcommit: fa32b1893286f20271fa4ec4be8fc68bd135f53c
ms.translationtype: HT
ms.contentlocale: uk-UA
ms.lasthandoff: 02/15/2021
ms.locfileid: "5274348"
---
# <a name="configure-automatic-invoice-creation---lite"></a><span data-ttu-id="d55be-103">Налаштування автоматичного створення рахунків – легка версія</span><span class="sxs-lookup"><span data-stu-id="d55be-103">Configure automatic invoice creation - lite</span></span>
 
<span data-ttu-id="d55be-104">_**Застосовується до:** розгортання Lite: від угоди до рахунків-проформ_</span><span class="sxs-lookup"><span data-stu-id="d55be-104">_**Applies To:** Lite deployment - deal to proforma invoicing_</span></span>

<span data-ttu-id="d55be-105">У Dynamics 365 Project Operations ви можете налаштувати автоматичне створення рахунків.</span><span class="sxs-lookup"><span data-stu-id="d55be-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="d55be-106">Система створює чернетки рахунків-проформ, спираючись на розклад виставлення рахунків для кожного сервісного договору проекту та сервісної роботи за договором.</span><span class="sxs-lookup"><span data-stu-id="d55be-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="d55be-107">Розклади виставлення рахунків-фактур налаштовуються на рівні сервісної роботи за договором.</span><span class="sxs-lookup"><span data-stu-id="d55be-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="d55be-108">Кожна позиція у сервісному договорі може мати окремий розклад виставлення рахунків-фактур, або ж для кожної позиції сервісного договору може зазначатися однаковий розклад.</span><span class="sxs-lookup"><span data-stu-id="d55be-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="d55be-109">При створенні рахунка-фактури система завжди створює для сервісного договору щонайменше один рахунок-фактуру.</span><span class="sxs-lookup"><span data-stu-id="d55be-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="d55be-110">У деяких випадках може створюватись декілька рахунків-фактур.</span><span class="sxs-lookup"><span data-stu-id="d55be-110">In some cases, there may be multiple invoices created.</span></span>

<span data-ttu-id="d55be-111">Наприклад, якщо сервісний договір передбачає кілька клієнтів, для сервісного договору проекту створюватиметься така ж кількість рахунків-фактур, скільки у ньому існує клієнтів із оплачуваними транзакціями, для яких необхідно створити рахунок-фактуру.</span><span class="sxs-lookup"><span data-stu-id="d55be-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="d55be-112">Дізнайтеся, як транзакції вносяться до рахунків-фактур.</span><span class="sxs-lookup"><span data-stu-id="d55be-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="d55be-113">Іноді кожна сервісна робота за договором на основі проекту визначає окремий розклад виставлення рахунків-фактур.</span><span class="sxs-lookup"><span data-stu-id="d55be-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="d55be-114">Наприклад, послуги з реалізації контракту Adatum передбачають перелічені нижче сервісні роботи за договором.</span><span class="sxs-lookup"><span data-stu-id="d55be-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="d55be-115">Робота над створенням працюючого зразка, котра має фіксовану ціну та два проміжних етапи, створених вручну.</span><span class="sxs-lookup"><span data-stu-id="d55be-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="d55be-116">Робота із запровадження, що включає Час, і для неї потрібно виставляти рахунки тиждень через тиждень по понеділках.</span><span class="sxs-lookup"><span data-stu-id="d55be-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="d55be-117">Понесені витрати, рахунки за які слід виставляти у перший понеділок кожного місяця.</span><span class="sxs-lookup"><span data-stu-id="d55be-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="d55be-118">Розклади виставлення рахунків-фактур, визначені для кожної з цих двох позицій, виглядають, як показано у таблиці нижче.</span><span class="sxs-lookup"><span data-stu-id="d55be-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="d55be-119">Сервісна робота за договором</span><span class="sxs-lookup"><span data-stu-id="d55be-119">Contract line</span></span> | <span data-ttu-id="d55be-120">Дата виставлення рахунка</span><span class="sxs-lookup"><span data-stu-id="d55be-120">Invoice run date</span></span> | <span data-ttu-id="d55be-121">Дата переривання транзакції</span><span class="sxs-lookup"><span data-stu-id="d55be-121">Transaction cut-off date</span></span> | <span data-ttu-id="d55be-122">Дата проміжного етапу</span><span class="sxs-lookup"><span data-stu-id="d55be-122">Milestone date</span></span> | <span data-ttu-id="d55be-123">Сума на проміжному етапі</span><span class="sxs-lookup"><span data-stu-id="d55be-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="d55be-124">Робота зі створення працюючого зразка</span><span class="sxs-lookup"><span data-stu-id="d55be-124">Prototype work</span></span> | <span data-ttu-id="d55be-125">5 жовтня, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-125">October 5, Monday</span></span> | - | <span data-ttu-id="d55be-126">5 жовтня, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-126">October 5, Monday</span></span> | <span data-ttu-id="d55be-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="d55be-127">5000 USD</span></span> |
| - | <span data-ttu-id="d55be-128">Вівторок, 3 листопада</span><span class="sxs-lookup"><span data-stu-id="d55be-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="d55be-129">Вівторок, 3 листопада</span><span class="sxs-lookup"><span data-stu-id="d55be-129">November 3, Tuesday</span></span> | <span data-ttu-id="d55be-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="d55be-130">12,000 USD</span></span> |
| <span data-ttu-id="d55be-131">Робота із запровадження</span><span class="sxs-lookup"><span data-stu-id="d55be-131">Implementation work</span></span> | <span data-ttu-id="d55be-132">5 жовтня, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-132">October 5, Monday</span></span> | <span data-ttu-id="d55be-133">4 жовтня, неділя</span><span class="sxs-lookup"><span data-stu-id="d55be-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d55be-134">19 жовтня, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-134">October 19, Monday</span></span> | <span data-ttu-id="d55be-135">18 жовтня, неділя</span><span class="sxs-lookup"><span data-stu-id="d55be-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d55be-136">2 листопада, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-136">November 2, Monday</span></span> | <span data-ttu-id="d55be-137">1 листопада, неділя</span><span class="sxs-lookup"><span data-stu-id="d55be-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d55be-138">16 листопада, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-138">November 16, Monday</span></span> | <span data-ttu-id="d55be-139">15 листопада, неділя</span><span class="sxs-lookup"><span data-stu-id="d55be-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="d55be-140">Понесені витрати</span><span class="sxs-lookup"><span data-stu-id="d55be-140">Expenses incurred</span></span> | <span data-ttu-id="d55be-141">5 жовтня, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-141">October 5, Monday</span></span> | <span data-ttu-id="d55be-142">4 жовтня, неділя</span><span class="sxs-lookup"><span data-stu-id="d55be-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="d55be-143">2 листопада, понеділок</span><span class="sxs-lookup"><span data-stu-id="d55be-143">November 2, Monday</span></span> | <span data-ttu-id="d55be-144">1 листопада, неділя</span><span class="sxs-lookup"><span data-stu-id="d55be-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="d55be-145">У цьому прикладі під час кожного виконання автоматичного виставлення рахунків-фактур виконуються перелічені нижче події.</span><span class="sxs-lookup"><span data-stu-id="d55be-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="d55be-146">**4 жовтня або будь-коли раніше**: жоден рахунок-фактура не створюється для цього сервісного договору, оскільки у таблиці **Розклад виставлення рахунків-фактур** для кожної з цих сервісних робіт за договором не зазначено неділю, 4 жовтня, в якості дати виставлення рахунка-фактури.</span><span class="sxs-lookup"><span data-stu-id="d55be-146">**October 4 or any date before**: No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="d55be-147">**5 жовтня, понеділок**: створюється один рахунок-фактура для:</span><span class="sxs-lookup"><span data-stu-id="d55be-147">**October 5 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="d55be-148">Роботи зі створення працюючого зразка, яка включає в себе проміжний етап, якщо він позначений як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="d55be-149">Роботи із впровадження, яка включає в себе всі транзакції часу, створені до дати відсікання транзакцій, 4 жовтня (неділя), позначені як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="d55be-150">Понесених витрат, які включають в себе всі транзакції витрат, створені до дати відсікання транзакцій, 4 жовтня (неділя), позначені як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="d55be-151">**6 жовтня або будь-коли раніше 19 жовтня**: жоден рахунок-фактура не створюється для цього сервісного договору, оскільки у таблиці **Розклад виставлення рахунків-фактур** для кожної з цих сервісних робіт за договором не зазначено 6 жовтня або жодну іншу дату раніше 19 жовтня в якості дати виставлення рахунка-фактури.</span><span class="sxs-lookup"><span data-stu-id="d55be-151">**On October 6 or any date before October 19**: No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="d55be-152">**19 жовтня, понеділок**: один рахунок-фактура створюється для роботи із впровадження, яка включає в себе всі транзакції часу, створені до дати відсікання транзакцій, 18 жовтня (неділя), позначені як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-152">**October 19, Monday**: One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="d55be-153">**2 листопада, понеділок**: створюється один рахунок-фактура для:</span><span class="sxs-lookup"><span data-stu-id="d55be-153">**November 2 Monday**: One invoice is generated for:</span></span>

    - <span data-ttu-id="d55be-154">Роботи із впровадження, яка включає в себе всі транзакції часу, створені до дати відсікання транзакцій, 1 листопада (неділя), позначені як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="d55be-155">Понесених витрат, які включають в себе всі транзакції витрат, створені до дати відсікання транзакцій, 1 листопада (неділя), позначені як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="d55be-156">**3 листопада, вівторок**: один рахунок-фактура створюється для роботи зі створення робочого зразка, яка включає в себе проміжний етап із сумою 12000 доларів США, якщо його позначено як **Готово до виставлення рахунку-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-156">**November 3, Tuesday**: One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="d55be-157">Налаштування автоматичного виставлення рахунків-фактур</span><span class="sxs-lookup"><span data-stu-id="d55be-157">Configure automatic invoicing</span></span>

<span data-ttu-id="d55be-158">Виконайте наведені нижче кроки для налаштування автоматизованого виконання виставлення рахунків-фактур.</span><span class="sxs-lookup"><span data-stu-id="d55be-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="d55be-159">У програмі **Project Operations** відкрийте **Параметри** > **Настроювання повторюваного рахунка-фактури**.</span><span class="sxs-lookup"><span data-stu-id="d55be-159">In **Project Operations**, go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="d55be-160">Створіть пакетну роботу і назвіть її **Створення рахунків-фактур Project Operations**.</span><span class="sxs-lookup"><span data-stu-id="d55be-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="d55be-161">Ім'я пакетного завдання має містити слова «Створення рахунків-фактур».</span><span class="sxs-lookup"><span data-stu-id="d55be-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="d55be-162">У полі **Тип завдання** виберіть параметр **Немає**.</span><span class="sxs-lookup"><span data-stu-id="d55be-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="d55be-163">За замовчуванням поля **Щоденна частота** і **Активовано** мають значення **Так**.</span><span class="sxs-lookup"><span data-stu-id="d55be-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="d55be-164">Виберіть **Запустити робочий цикл**.</span><span class="sxs-lookup"><span data-stu-id="d55be-164">Select **Run Workflow**.</span></span> <span data-ttu-id="d55be-165">У діалоговому вікні **Пошук записів** відображаються три робочі цикли.</span><span class="sxs-lookup"><span data-stu-id="d55be-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="d55be-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="d55be-166">ProcessRunCaller</span></span>
- <span data-ttu-id="d55be-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="d55be-167">ProcessRunner</span></span>
- <span data-ttu-id="d55be-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="d55be-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="d55be-169">Виберіть **ProcessRunCaller**, а потім натисніть **Додати**.</span><span class="sxs-lookup"><span data-stu-id="d55be-169">Select **ProcessRunCaller**, and then select **Add**.</span></span>
6. <span data-ttu-id="d55be-170">У подальшому діалоговому вікні натисніть кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="d55be-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="d55be-171">Робочий цикл **Сплячий режим** супроводжується робочим циклом **Процес**.</span><span class="sxs-lookup"><span data-stu-id="d55be-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="d55be-172">Також можна вибрати **ProcessRunner** у кроці 5.</span><span class="sxs-lookup"><span data-stu-id="d55be-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="d55be-173">Потім під час вибору **ОК** робочий цикл **Процес** відстежується робочим циклом **Сплячий режим**.</span><span class="sxs-lookup"><span data-stu-id="d55be-173">Then, when you select **OK**, a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="d55be-174">Робочі цикли **ProcessRunCaller** та **ProcessRunner** створюють рахунки.</span><span class="sxs-lookup"><span data-stu-id="d55be-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="d55be-175">**ProcessRunCaller** викликає **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="d55be-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="d55be-176">**ProcessRunner** — це робочий цикл, який фактично створює рахунки-фактури.</span><span class="sxs-lookup"><span data-stu-id="d55be-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="d55be-177">Робочий цикл рухається через всі позиції сервісного договору, для яких потрібно створити рахунки-фактури, і створює рахунки-фактури для цих позицій.</span><span class="sxs-lookup"><span data-stu-id="d55be-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="d55be-178">Для визначення сервісних робіт за договором, для яких мають бути створені рахунки-фактури, завдання буде дивитися на дату створення рахунка для сервісних робіт за договором.</span><span class="sxs-lookup"><span data-stu-id="d55be-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="d55be-179">Якщо сервісна робота за договором, що належить до одного сервісного договору, має однакову дату виставлення рахунка-фактури, транзакції об'єднуються в один рахунок-фактуру з двома позиціями рахунка.</span><span class="sxs-lookup"><span data-stu-id="d55be-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="d55be-180">Якщо транзакції для створення рахунків-фактур відсутні, завдання пропускає створення рахунка-фактури.</span><span class="sxs-lookup"><span data-stu-id="d55be-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="d55be-181">Після завершення обробки **ProcessRunner** програма викликає **ProcessRunCaller**, забезпечує час завершення і закривається.</span><span class="sxs-lookup"><span data-stu-id="d55be-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller**, provides the end time, and is closed.</span></span> <span data-ttu-id="d55be-182">Після цього **ProcessRunCaller** запускає таймер на 24 години від указаного часу завершення.</span><span class="sxs-lookup"><span data-stu-id="d55be-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="d55be-183">Після завершення таймера **ProcessRunCaller** закривається.</span><span class="sxs-lookup"><span data-stu-id="d55be-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="d55be-184">Завдання пакетної обробки для створення рахунків-фактур — це повторюване завдання.</span><span class="sxs-lookup"><span data-stu-id="d55be-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="d55be-185">Якщо запустити цей пакетний процес багато разів, буде створено кілька екземплярів завдання, і виникнуть помилки.</span><span class="sxs-lookup"><span data-stu-id="d55be-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="d55be-186">Тому процес пакетної обробки слід запустити лише один раз і перезапустити його, лише якщо він припинить роботу.</span><span class="sxs-lookup"><span data-stu-id="d55be-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="d55be-187">Пакетне виставлення рахунків-фактур у Project Operations запускається лише для сервісних робіт за договором проекту, налаштованих у розкладі виставлення рахунків-фактур.</span><span class="sxs-lookup"><span data-stu-id="d55be-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="d55be-188">Для способу виставлення рахунків за сервісну роботу за договором із фіксованою ціною мають бути налаштовані на основні етапи.</span><span class="sxs-lookup"><span data-stu-id="d55be-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="d55be-189">Для сервісної роботи за договором в рамках проекту з методом виставлення рахунків за час та матеріали буде потрібно налаштувати розклад виставлення рахунків на основі дати.</span><span class="sxs-lookup"><span data-stu-id="d55be-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>


[!INCLUDE[footer-include](../../includes/footer-banner.md)]