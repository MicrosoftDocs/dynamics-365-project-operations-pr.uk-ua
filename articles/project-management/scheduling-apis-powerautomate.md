---
title: Використання API планування проектів з Power Automate
description: Ця стаття містить зразок циклу, який використовує інтерфейси прикладних програм (API) планування проектів.
author: ruhercul
ms.date: 01/26/2022
ms.topic: article
ms.reviewer: johnmichalak
ms.author: ruhercul
ms.openlocfilehash: afec082c680596e8dcb8ec0b350b4bb7853c49ff
ms.sourcegitcommit: 7ed8e77a92917f2d242988ca02bd7de9571cce5e
ms.translationtype: MT
ms.contentlocale: uk-UA
ms.lasthandoff: 09/02/2022
ms.locfileid: "9404467"
---
# <a name="use-project-schedule-apis-with-power-automate"></a>Використання API планування проектів з Power Automate

_**Застосовується до:** Project Operations для сценаріїв на основі ресурсів і відсутності запасів, полегшене розгортання: угоди та виставлення рахунків-проформ_

У цій статті описано приклад циклу, в якому демонструється створення повного плану проекту за допомогою Microsoft Power Automate, а також створення набору операцій і оновлення сутності. У прикладі показано, як створювати проект, учасників робочої групи проекту, набори операцій, завдання проектів і призначення ресурсів. У цій статті також пояснюється, як оновити сутність і виконати набір операцій.

Нижче наведено повний список кроків, описаних у прикладі циклу в цій статті:

1. [Створення тригера PowerApps](#1)
2. [Створити проект](#2)
3. [Ініціалізація змінної для учасника робочої групи](#3)
4. [Створення загального учасника робочої групи](#4)
5. [Створення набору параметрів](#5)
6. [Створення блоку даних проекту](#6)
7. [Ініціалізація змінної для стану зв’язку](#7)
8. [Ініціалізація змінної для кількості завдань](#8)
9. [Ініціалізація змінної для ідентифікатора проектного завдання](#9)
10. [Зробити до](#10)
11. [Налаштування проектного завдання](#11)
12. [Створення проектного завдання](#12)
13. [Створення призначення ресурсів](#13)
14. [Зменшення змінної](#14)
15. [Перейменування проектного завдання](#15)
16. [Виконання набору параметрів](#16)

## <a name="assumptions"></a>Припущення

У цій статті припускається, що ви маєте базові знання платформи Dataverse, хмарних циклів та інтерфейси прикладних програм (API) планування проектів. Додаткові відомості див. в розділі [Посилання](#references) далі в цій статті.

## <a name="create-a-flow"></a>Створити цикл

### <a name="select-an-environment"></a>Виберіть середовище

Цикл Power Automate не можна створювати у вашому середовищі.

1. Відкрийте <https://flow.microsoft.com> та увійдіть з обліковими даними адміністратора.
2. У верхньому правому куті виберіть **Середовища**.
3. У списку виберіть середовище, в якому інстальовано Dynamics 365 Project Operations.

### <a name="create-a-solution"></a>Створення рішення

Виконайте ці кроки, щоб створити [цикл з урахуванням рішень](/power-automate/overview-solution-flows). Створивши цикл з урахуванням рішень, можна легше експортувати його для подальшого використання.

1. В області переходів виберіть **Рішення**.
2. На сторінці **Рішення** виберіть **Нове рішення**.
3. У діалоговому вікні **Нове рішення** встановіть обов’язкові поля, а потім виберіть **Створити**.

## <a name="step-1-create-a-powerapps-trigger"></a><a id="1"></a>Крок 1: створення тригера PowerApps

1. На сторінці **Рішення** виберіть створене вами рішення, а потім натисніть **Створити**.
2. В області ліворуч виберіть **Хмарні цикли** \> **Автоматизація** \> **Хмарний цикл** \> **Миттєвий**.
3. У полі **Ім’я циклу** введіть **Демонстраційний цикл API розкладу**.
4. В списку **Виберіть, як ініціюватиметься цей цикл** виберіть **Power Apps**. Під час створення тригера Power Apps логіка залежить від вас як автора. У цій статті параметри вводу залиште пустими для цілей тестування.
5. Виберіть **Створити**.

## <a name="step-2-create-a-project"></a><a id="2"></a>Крок 2. Створення проекту

Щоб створити зразок проекту, виконайте зазначені нижче дії.

1. У створеному циклі виберіть **Новий крок**.

    ![Додавання нового кроку.](media/newstep.png)

2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.

    ![Вибір операції.](media/chooseactiontab.png)

3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.

![Перейменування кроку.](media/renamestep.png)

4. Перейменуйте крок **Створення проекту**.
5. У полі **Ім’я дії** виберіть параметр **msdyn\_CreateProjectV1**.
6. У полі **msdyn\_subject** виберіть **Додати динамічний вміст**.
7. На вкладці **Вираз** у полі функції введіть **Ім’я проекту – utcNow()**.
8. Виберіть **ОК**.

## <a name="step-3-initialize-a-variable-for-the-team-member"></a><a id="3"></a>Крок 3: ініціалізація змінної для учасника робочої групи

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Ініціалізація змінної**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Ініціалізувати учасника робочої групи**.
5. У полі **Ім’я** введіть **TeamMemberAction**.
6. У полі **Тип** виберіть параметр **Рядок**.
7. У полі **Значення** введіть **msdyn\_CreateTeamMemberV1**.

## <a name="step-4-create-a-generic-team-member"></a><a id="4"></a>Крок 4: створення загального учасника робочої групи

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Створення учасника робочої групи**.
5. Для поля **Ім’я дії** виберіть **TeamMemberAction»** в діалоговому вікні **Динамічний вміст**.
6. У полі **Параметри дії** введіть наведені нижче відомості про параметр.

    ```
    {
        "TeamMember": {
            "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projectteam",
            "msdyn_projectteamid": "@{guid()}",
            "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
            "msdyn_name": "ScheduleAPIDemoTM1"
        }
    } 
    ```

    Нижче наведено пояснення параметрів.

    - **\@\@odata.type** – ім’я сутності. Наприклад, введіть **Microsoft.Dynamics.CRM.msdyn\_projectteam**.
    - **msdyn\_projectteamid** – первинний ключ ідентифікатора робочої групи проекту. Це значення є виразом глобального унікального ідентифікатора (GUID).   Ідентифікатор створюється на вкладці «Вираз».

    - **msdyn\_project\@odata.bind** – ідентифікатор відповідального проекту. Значення буде динамічним вмістом, отриманим від відповіді кроку «Створити проект». Переконайтеся, що введено повний шлях до динамічного вмісту в дужках. Необхідні лапки. Наприклад, введіть **"/msdyn\_projects(ADD DYNAMIC CONTENT)"**.
    - **msdyn\_name** – ім’я учасника групи проекту. Наприклад, введіть **"ScheduleAPIDemoTM1"**.

## <a name="step-5-create-an-operation-set"></a><a id="5"></a>Крок 5: створення набору параметрів

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Створити набір параметрів**.
5. У полі **Ім’я дії** виберіть настроювану дію **msdyn\_CreateOperationSetV1** Dataverse.
6. У полі **Опис** введіть **ScheduleAPIDemoOperationSet**.
7. У полі **Проект** введіть **/msdyn\_projects(**.
8. У діалоговому вікні **Динамічний вміст** виберіть **msdyn\_CreateProjectV1Response ProjectId**.
9. У полі **Проект** введіть **)**.

## <a name="step-6-create-a-project-bucket"></a><a id="6"></a>Крок 6. Створення блоку даних проекту

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **додати новий рядок**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Створення блоку даних**.
5. У полі **Ім'я таблиці** виберіть **Блоки даних проекту**.
6. У полі **Ім’я** введіть **ScheduleAPIDemoBucket1**.
7. Для поля **Проект** виберіть **msdyn\_CreateProjectV1Response ProjectId** у діалоговому вікні **Динамічний вміст**.

## <a name="step-7-initialize-a-variable-for-the-link-status"></a><a id="7"></a>Крок 7: ініціалізація змінної для стану зв’язку

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Ініціалізація змінної**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Init linkstatus**.
5. У полі **Ім’я** введіть **linkstatus**.
6. У полі **Тип** виберіть параметр **Ціле число**.
7. У полі **Значення** введіть **192350000**.

## <a name="step-8-initialize-a-variable-for-the-number-of-tasks"></a><a id="8"></a>Крок 8: ініціалізація змінної для кількості завдань

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Ініціалізація змінної**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Вихідна кількість завдань**.
5. У полі **Ім’я** введіть **кількість завдань**.
6. У полі **Тип** виберіть параметр **Ціле число**.
7. У полі **Значення** введіть **5**.

## <a name="step-9-initialize-a-variable-for-the-project-task-id"></a><a id="9"></a>Крок 9: ініціалізація змінної для ідентифікатора проектного завдання

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Ініціалізація змінної**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Init ProjectTaskID**.
5. У полі **Ім’я** введіть **кількість завдань**.
6. У полі **Тип** виберіть параметр **Рядок**.
7. Для поля **Значення** введіть **guid()** у конструктор виразів.

## <a name="step-10-do-until"></a><a id="10"></a>Крок 10: зробити до

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **зробити до**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. Установіть для першого значення умовного виразу змінну **кількість завдань** у діалоговому вікні **Динамічний вміст**.
4. Установіть для умови значення **менше або дорівнює**.
5. Установіть друге значення в умовному виразі на **0**.

## <a name="step-11-set-a-project-task"></a><a id="11"></a>Крок 11: налаштування проектного завдання

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **установка змінної**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На новому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Установити завдання проекту**.
5. У полі **Ім’я** виберіть параметр **msdyn\_projecttaskid**.
6. Для поля **Значення** введіть **guid()** у конструктор виразів.

## <a name="step-12-create-a-project-task"></a><a id="12"></a>Крок 12. Створення завдання проекту

Виконайте такі кроки, щоб створити завдання проекту з унікальним ідентифікатором, що належить до поточного проекту та створеного блоку даних проекту.

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На цьому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Створити завдання проекту**.
5. У полі **Ім’я дії** виберіть параметр **msdyn\_PssCreateV1**.
6. У полі **Сутність** введіть наступні відомості про параметр.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_project@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})",
        "msdyn_subject": "ScheduleAPIDemoTask1",
        "msdyn_projectbucket@odata.bind": "/msdyn_projectbuckets(@{outputs('Create_Project_Buckets')?['body/msdyn_projectbucketid']})",
        "msdyn_start": "@{addDays(utcNow(), 1)}",
        "msdyn_scheduledstart": "@{utcNow()}",
        "msdyn_scheduledend": "@{addDays(utcNow(), 5)}",
        "msdyn_LinkStatus": "192350000"
    }
    ```

    Нижче наведено пояснення параметрів.

    - **\@\@odata.type** – ім’я сутності. Наприклад, введіть **Microsoft.Dynamics.CRM.msdyn\_projecttask**.
    - **msdyn\_projecttaskid** – унікальний ідентифікатор завдання. Для значення має бути встановлена динамічна змінна з **msdyn\_projecttaskid**.
    - **msdyn\_project\@odata.bind** – ідентифікатор відповідального проекту. Значення буде динамічним вмістом, отриманим від відповіді кроку «Створити проект». Переконайтеся, що введено повний шлях до динамічного вмісту в дужках. Необхідні лапки. Наприклад, введіть **"/msdyn\_projects(ADD DYNAMIC CONTENT)"**.
    - **msdyn\_subject** – будь-яке ім’я завдання.
    - **msdyn\_projectbucket\@odata.bind** – блок даних проекту, в якому містяться завдання. Значення буде динамічним вмістом, отриманим від відповіді кроку «Створити блок даних». Переконайтеся, що введено повний шлях до динамічного вмісту в дужках. Необхідні лапки. Наприклад, введіть **"/msdyn\_projectbuckets(ADD DYNAMIC CONTENT)"**.
    - **msdyn\_start** – динамічний вміст на дату початку. Наприклад, завтра буде представлено як **"addDays(utcNow(), 1)"**.
    - **msdyn\_scheduledstart** – запланована дата початку. Наприклад, завтра буде представлено як **"addDays(utcNow(), 1)"**.
    - **msdyn\_scheduleend** – запланована дата завершення. Виберіть дату в майбутньому. Наприклад, укажіть **"addDays(utcNow(), 5)"**.
    - **msdyn\_LinkStatus** – стан зв’язку. Наприклад, введіть **"192350000"**.

7. Для поля **OperationSetId** виберіть **msdyn\_CreateOperationSetV1Response** у діалоговому вікні **Динамічний вміст**.

## <a name="step-13-create-a-resource-assignment"></a><a id="13"></a>Крок 13: створення призначення ресурсів

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На цьому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Створення призначення**.
5. У полі **Ім’я дії** виберіть параметр **msdyn\_PssCreateV1**.
6. У полі **Сутність** введіть наступні відомості про параметр.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_resourceassignment",
        "msdyn_resourceassignmentid": "@{guid()}",
        "msdyn_name": "ScheduleAPIDemoAssign1",
        "msdyn_taskid@odata.bind": "/msdyn_projecttasks(@{variables('msdyn_projecttaskid')})",
        "msdyn_projectteamid@odata.bind": "/msdyn_projectteams(@{outputs('Create_Team_Member')?['body/TeamMemberId']})",
        "msdyn_projectid@odata.bind": "/msdyn_projects(@{outputs('Create_Project')?['body/ProjectId']})"
    }
    ```

7. Для поля **OperationSetId** виберіть **msdyn\_CreateOperationSetV1Response** у діалоговому вікні **Динамічний вміст**.

## <a name="step-14-decrement-a-variable"></a><a id="14"></a>Крок 14: зменшення змінної

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **зменшення змінної**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. У полі **Ім’я** виберіть **кількість завдань**.
4. У полі **Значення** введіть **1**.

## <a name="step-15-rename-a-project-task"></a><a id="15"></a>Крок 15: перейменування завдання проекту

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На цьому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Перейменувати завдання проекту**.
5. У полі **Ім’я дії** виберіть параметр **msdyn\_PssUpdateV1**.
6. У полі **Сутність** введіть наступні відомості про параметр.

    ```
    {
        "@@odata.type": "Microsoft.Dynamics.CRM.msdyn_projecttask",
        "msdyn_projecttaskid": "@{variables('msdyn_projecttaskid')}",
        "msdyn_subject": "ScheduleDemoTask1-UpdatedName"
    }
    ```

7. Для поля **OperationSetId** виберіть **msdyn\_CreateOperationSetV1Response** у діалоговому вікні **Динамічний вміст**.

## <a name="step-16-run-an-operation-set"></a><a id="16"></a>Крок 16: виконання набору параметрів

1. У циклі виберіть **Новий крок**.
2. У діалоговому вікні **Вибрати операцію** в полі пошуку введіть **Виконати незв’язану дію**. Потім на вкладці **Дії** виберіть операцію у списку результатів.
3. На цьому кроці виберіть три крапки (**...**), а потім виберіть **Перейменувати**.
4. Перейменуйте крок **Виконати набір параметрів**.
5. У полі **Ім’я дії** виберіть параметр **msdyn\_ExecuteOperationSetV1**.
6. Для поля **OperationSetId** виберіть **msdyn\_CreateOperationSetV1Response OperationSetId** у діалоговому вікні **Динамічний вміст**.

## <a name="references"></a>Посилання

- [Огляд інтеграції циклів з Dataverse - Power Automate](/power-automate/dataverse/overview?WT.mc_id=email)
- [Використання API розкладів проектів для виконання операцій із сутностями планування](schedule-api-preview.md)
- [Огляд хмарних циклів — Power Automate](/power-automate/overview-cloud?WT.mc_id=email)
- [Огляд циклів на основі рішень — Power Automate](/power-automate/overview-solution-flows?WT.mc_id=email)
