---
title: Синхронізуйте сервісні договори проекту та проекти безпосередньо з Project Service Automation до Finance and Operations
description: У цій темі описується шаблон та основні завдання, що використовуються для синхронізації сервісних договорів проекту та проектів безпосередньо з Microsoft Dynamics 365 Project Service Automation до Dynamics 365 Finance.
author: Yowelle
manager: AnnBe
ms.date: 09/09/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 87983
ms.assetid: b454ad57-2fd6-46c9-a77e-646de4153067
ms.search.region: Global
ms.author: andchoi
ms.search.validFrom: 2017-12-13
ms.dyn365.ops.version: AX 7.3.0
ms.openlocfilehash: 0b3bc159fff25c4f6e5b1ed1b2eabbba675fb0f5
ms.sourcegitcommit: 573be7e36604ace82b35e439cfa748aa7c587415
ms.translationtype: HT
ms.contentlocale: uk-UA
ms.lasthandoff: 11/25/2020
ms.locfileid: "4642658"
---
# <a name="synchronize-project-contracts-and-projects-directly-from-project-service-automation-to-finance-and-operations"></a>Синхронізуйте сервісні договори проекту та проекти безпосередньо з Project Service Automation до Finance and Operations

[!include[banner](../includes/banner.md)]

[!include [rename-banner](~/includes/cc-data-platform-banner.md)]

У цій темі описується шаблон та основні завдання, що використовуються для синхронізації сервісних договорів проекту та проектів безпосередньо з Dynamics 365 Project Service Automation до Dynamics 365 Finance.

> [!NOTE] 
> Якщо ви використовуєте Enterprise edition 7.3.0, ви маєте інсталювати базу знань KB 4074835.

## <a name="data-flow-for-project-service-automation-to-finance"></a>Потік даних для Project Service Automation до Finance

> [!NOTE]
> Перш ніж використовувати Project Service Automation для рішення з інтеграції Finance, слід ознайомитися з функцією інтегрування даних з допомогою Dynamics 365.

У рішеннях із інтеграції Project Service Automation до Finance використовується функція інтеграції даних для синхронізації даних у екземплярах Project Service Automation і Finance. Шаблон інтеграції, доступний з функцією інтеграції даних, забезпечує потік даних про проект, сервісних договорів проекту, проектів, сервісні роботи за договором проекту, етапи сервісних робіт за договором проекту з Project Service Automation до Finance.

Наведена далі ілюстрація показує, як синхронізуються дані між Project Service Automation і Finance.

[![Потік даних для інтеграції Project Service Automation з Finance](./media/ProjectsAndContractsFlow_upd.JPG)](./media/ProjectsAndContractsFlow.JPG)

## <a name="templates-and-tasks"></a>Шаблони й завдання

Для здійснення доступу до наявних шаблонів у центрі адміністрування Microsoft Power Apps виберіть **Проекти**, потім у верхньому правому куті виберіть **Новий проект**, щоб здійснити вибір загальнодоступних шаблонів.

Наведені далі шаблони й основні завдання використовуються для синхронізації сервісних договорів проектів та проектів з Project Service Automation до Finance:

### <a name="integrating-with-dynamics-365-project-service-automation-v2x"></a>Інтеграція з Dynamics 365 Project Service Automation v2.x
- **Найменування шаблону в інтеграції даних:** Проекти та сервісні договори (PSA до Fin і Ops)
- **Найменування завдань у проекті:**

    - Сервісні договори проекту PSA в Fin і OPS
    - Проекти PSA в Fin і Ops
    - Сервісні роботи за договором проекту PSA в Fin і Ops
    - Проміжні етапи сервісних робіт за договором проекту PSA в Fin і Ops
  
### <a name="integrating-with-dynamics-365-project-service-automation-v3x"></a>Інтеграція з Dynamics 365 Project Service Automation v3.x
Існує зміна схеми в Project Service Automation, яка впливає на шаблон проміжного етапу сервісної роботи за договором і використовує V2-версію шаблону, щоб інтегрувати програму Project Service Automation V3. x з Dynamics 365.

- **Найменування шаблону в інтеграції даних:** проекти та сервісні договори (PSA 3.x до Fin і Ops) - v2
- **Найменування завдань у проекті:**

    - Сервісні договори проекту PSA в Fin і OPS
    - Проекти PSA в Fin і Ops
    - Сервісні роботи за договором проекту PSA в Fin і Ops
    - Проміжні етапи сервісних робіт за договором проекту PSA в Fin і Ops

Щоб уможливити синхронізацію сервісних договорів проекту та проектів ви маєте синхронізувати облікові записи.

## <a name="entity-set"></a>Група сутностей

| Project Service Automation       | Фінанси                                                |
|----------------------------------|--------------------------------------------------------|
| Замовлення                           | Сутність інтеграції для сервісних договорів проекту                |
| Проекти                         | Сутність інтеграції для проекту                         |
| Позиції замовлення                      | Сутність інтеграції для сервісної роботи за договором проекту           |
| Проміжні етапи сервісної роботи за договором проекту | Сутність інтеграції для проміжних етапів сервісної роботи за договором проекту |

## <a name="entity-flow"></a>Потік сутностей

Керування сервісними договорами проекту здійснюється в Project Service Automation, і вони синхронізуються в Finance як сервісні договори проекту. У рамках шаблону інтеграції можна задати джерело інтеграції у Finance для сервісного договору проекту.

Керування проектами часу та матеріалів і фіксованої ціни здійснюється в Project Service Automation, і вони синхронізуються в Finance як проекти. У рамках інтеграції шаблону можна задати джерело інтеграції у Finance для проекту.

Керування сервісною роботою за договорами проекту здійснюється в Project Service Automation, і вони синхронізуються в Finance як правила виставлення рахунків за сервісним договором проекту. Якщо метод виставлення рахунка відрізняється від типу проекту за замовчуванням, то в синхронізації оновлюється тип проекту для проекту сервісної роботи за договором і проектна група.

Керування проміжними етапами сервісної роботи за договорами проекту здійснюється в Project Service Automation, і вони синхронізуються в Finance як проміжні етапи правила виставлення рахунків за сервісним договором проекту.

## <a name="project-service-automation-to-finance-integration-solution"></a>Рішення для інтеграції Project Service Automation до Finance

Поле **Ідентифікатор сервісного договору проекту** доступне на сторінці **Сервісні договори проекту**. Це поле було створено природним і унікальним ключем для підтримки інтеграції.

Якщо під час створення нового сервісного договору проекту значення **Ідентифікатора сервісного договору проекту** ще не існує, воно автоматично генерується за допомогою числової послідовності. Значення складається з **ORD**, за яким слідує зростаюча числова послідовність і суфікс із шести символів. Ось приклад: **ORD-01022-Z4M9Q0**.

Поле **Номер проекту** доступне на сторінці **Проекти**. Це поле було створено природним і унікальним ключем для підтримки інтеграції.

Якщо під час створення нового проекту значення **Номер проекту** ще не існує, воно автоматично генерується за допомогою числової послідовності. Значення складається з **PRJ**, за яким слідує зростаюча числова послідовність і суфікс із шести символів. Ось приклад: **PRJ-01049-CCNID0**.

Коли застосовується рішення з інтеграції Project Service Automation у Finance, сценарій оновлення установлює поле **Ідентифікатор сервісного договору проекту** для наявних сервісних договорів проекту, а також поле **Номер проекту** для існуючих проектів в Project Service Automation.

## <a name="prerequisites-and-mapping-setup"></a>Необхідні компоненти та налаштування зіставлення

- Щоб уможливити синхронізацію сервісних договорів проекту та проектів ви маєте синхронізувати облікові записи.
- У наборі з'єднання додайте відображення поля ключа інтеграції для **msdyn\_organizationalunits** до **msdyn\_name \[Name\]**. Можливо, спочатку потрібно додати проект до набору підключень. Для отримання додаткових відомостей див. розділ [Інтеграція даних до Common Data Service для програм](https://docs.microsoft.com/powerapps/administrator/data-integrator).
- У наборі з'єднання додайте відображення поля ключа інтеграції для **msdyn\_projects** в **msdynce\_projectnumber \[Project Number\]**. Можливо, спочатку потрібно додати проект до набору підключень. Для отримання додаткових відомостей див. розділ [Інтеграція даних до Common Data Service для програм](https://docs.microsoft.com/powerapps/administrator/data-integrator).
- **SourceDataID** для сервісних договорів проекту та проектів можна оновити до іншого значення або видалити з зіставлення. Значення шаблону за замовчуванням — це **Project Service Automation**.
- Зіставлення **PaymentTerms** необхідно оновлювати таким чином, щоб воно відображало дійсні умови оплати у Finance. Крім того, можна видалити зіставлення з завдання проекту. У зіставленні значення за замовчуванням встановлено значення за замовчуванням для демонстраційних даних. У наведеній нижче таблиці показано значення в Project Service Automation.

    | Значення | Опис   |
    |-------|---------------|
    | 1     | Оплата через 30 днів        |
    | 2     | Оплата через 30 днів, у разі оплати через 10 днів знижка 2% |
    | 3     | Оплата через 45 днів        |
    | 4     | Оплата через 60 днів        |

## <a name="power-query"></a>Power Query

Якщо виконуються наведені умови, для фільтрування даних ви маєте використовувати Microsoft Power Query для Excel:

- У Dynamics 365 Sales є замовлення.
- У Project Service Automation є кілька організаційних одиниць, і ці організаційні одиниці будуть зіставлені з кількома юридичними особами у Finance.

Дотримуйтеся цих рекомендацій, якщо передбачається використання Power Query:

- У шаблоні проектів і сервісних договорів (PSA в Fin і Ops) є фільтр за замовчуванням, який містить лише замовлення на продаж типу **Work item (msdyn\_ordertype = 192350001)**. Цей фільтр допомагає гарантувати, що сервісні договори проектів не створюються для замовлень на продаж у Finance. Цей фільтр слід додати в разі створення власного шаблона.
- Слід створити фільтр Power Query, який містить тільки контрактні організації, які мають синхронізуватися з юридичною особою набору інтеграційного з'єднання. Наприклад, сервісні договори проекту, які ви маєте з організаційної одиницею сервісного договору Contoso US мають бути синхронізовані з юридичною особою USSI, але сервісні договори проекту, які ви маєте з організаційною одиницею Contoso Global мають бути синхронізовані з юридичною особою USMF. Якщо цей фільтр не додано до зіставлення завдань, усі сервісні договори проекту буде синхронізовано з юридичною особою, визначеною для набору підключень, незалежно від організаційної одиниці сервісного договору.

## <a name="template-mapping-in-data-integration"></a>Зіставлення шаблонів у інтеграції даних

> [!NOTE] 
> Поля **CustomerReference**, **AddressCity**, **AddressCountryRegionID**, **AddressDescription**, **AddressLine1**, **AddressLine2**, **AddressState**, і **AddressZipCode** не включаються в зіставлення за замовчуванням для сервісних договорів проекту. Можна додати зіставлення, якщо потрібно, щоб ці дані було синхронізовано для сервісних договорів проекту.
>
> Поля **Description**, **ParentID**, **ProjectGroup**, **ProjectManagerPersonnelNumber** і **ProjectType** не включаються до зіставлення за замовчуванням для проекту. Можна додати зіставлення, якщо потрібно, щоб ці дані було синхронізовано для проектів.

Наведені далі ілюстрації показують приклади зіставлення завдань шаблону в інтеграції даних. У зіставленні показано інформацію поля, яку буде синхронізовано з Project Service Automation до Finance.

[![Зіставлення шаблону проекту для проектної угоди](./media/ProjectContractTemplateMapping.JPG)](./media/ProjectContractTemplateMapping.JPG)

[![Зіставлення шаблону проекту](./media/ProjectTemplateMapping.JPG)](./media/ProjectTemplateMapping.JPG)

[![Зіставлення шаблону сервісної роботи за договором проекту](./media/ProjectContractLinesMapping.JPG)](./media/ProjectContractLinesMapping.JPG)

[![Зіставлення шаблону проміжних етапів сервісної роботи за договором проекту](./media/ProjectContractLineMilestonesMapping.JPG)](./media/ProjectContractLineMilestonesMapping.JPG)

#### <a name="project-contract-line-milestone-mapping-in-the-projects-and-contracts-psa-3x-to-dynamics---v2-template"></a>Зіставлення проміжного етапу сервісної роботи за договором у проектах та сервісних договорах (PSA 3. x до Dynamics) — шаблон v2.

[![Зіставлення шаблону проміжних етапів сервісної роботи за договором проекту з шаблоном версії 2](./media/ProjectContractLineMilestoneMapping_v2.jpg)](./media/ProjectContractLineMilestoneMapping_v2.jpg)
