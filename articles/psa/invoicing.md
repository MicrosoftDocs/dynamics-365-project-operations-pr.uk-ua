---
title: Виставлення рахунків у Project Service Automation
description: У цьому розділі наведено відомості про виставлення рахунків.
author: rumant
ms.custom:
- dyn365-projectservice
ms.date: 08/03/2020
ms.topic: article
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
- ProjectOperations
ms.reviewer: johnmichalak
ms.openlocfilehash: 84134778225bfce1126ccf70b32e0c82c4ccc3fc
ms.sourcegitcommit: c0792bd65d92db25e0e8864879a19c4b93efb10c
ms.translationtype: MT
ms.contentlocale: uk-UA
ms.lasthandoff: 04/14/2022
ms.locfileid: "8579331"
---
# <a name="invoicing-in-project-service-automation"></a>Виставлення рахунків у Project Service Automation

[!include [banner](../includes/psa-now-project-operations.md)]

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

Виставлення рахунків у Dynamics 365 Project Service Automation корисне тим, що це надає керівникам проектів другий рівень затвердження, перш ніж вони почнуть створювати рахунки-фактури для клієнтів. Перший рівень затвердження завершується, коли буде затверджено записи часу та витрат, які надсилають учасники робочої групи проекту.

PSA не призначена для створення рахунків-фактур, призначених для клієнтів, з наступних причин:

- Вона не містить податкову інформацію.
- Вона не може перетворити інші грошові одиниці на грошову одиницю рахунка-фактури за допомогою правильно настроєних курсів валют.
- Вона не може правильно форматувати рахунки-фактури, щоб їх можна було друкувати.

Натомість можна скористатися системою фінансового або бухгалтерського обліку, щоб створити рахунки-фактури для клієнтів, які використовують інформацію із пропозицій рахунків-фактур, що згенеровані в PSA.

## <a name="creating-project-invoices-in-psa"></a>Створення рахунків проекту в PSA

Проектні рахунки-фактури можна створювати по одному або групою. Їх можна створити вручну або настроїти таким чином, щоб вони були згенеровані в автоматичних циклах.

### <a name="manually-create-project-invoices-in-psa"></a>Створення рахунків проекту в PSA вручну

На сторінці списку **Проектні договори** можна створити рахунки-фактури проекту окремо для кожного сервісного договору, або створити рахунки-фактури групою для кількох сервісних договорів.

За допомогою цього кроку можна створити рахунок-фактуру для певного сервісного договору проекту.

- На сторінці списку **Проектні договори** відкрийте проектний договір, а потім виберіть **Створити рахунок-фактуру**.

    ![Створення рахунків-фактур для певного проектного сервісного договору.](media/CreateProjectInvoicesOneByOne.png)

    Рахунок-фактура створюється для всіх транзакцій для вибраного сервісного договору, який має статус **Готової до виставлення рахунку**. Ці транзакції включають час, витрати, етапи і сервісну роботу за договором на основі продукту.

Виконайте такі кроки, щоб створити рахунки групою.

1. На сторінці списку **Проектні договори** виберіть один або кілька проектних договорів, для яких потрібно створити рахунок-фактуру, а потім виберіть команду **Створити рахунки для проекту**.

    ![Групове створення рахунків у проекті.](media/CreateProjectInvoicesBulk.png)

    Попереджувальний сигнал інформує вас про те, що перед створенням рахунків-фактур може виникнути затримка. Цей процес також відображається.

2. Виберіть кнопку **ОК**, щоб закрити діалогове вікно.

    Рахунок-фактура створюється для всіх транзакцій у сервісній роботі за договором, які мають статус **Готово до виставлення рахунка**. Ці транзакції включають час, витрати, етапи і сервісну роботу за договором на основі продукту.

3. Щоб переглянути отримані рахунки-фактури, виберіть **Sales** \> **Виставлення рахунків** \> **Рахунки-фактури**. Для кожного проектного договору відображатиметься один рахунок-фактура.

### <a name="set-up-automated-creation-of-project-invoices-in-psa"></a>Настройте автоматичне створення рахунків-фактур проекту в PSA

Виконайте наведені нижче кроки, щоб настроїти автоматизоване виставлення рахунків в PSA.

1. Перейдіть у **Project Service** \> **Настройки** \> **Пакетні завдання**.
2. Створіть пакетну роботу і назвіть її **Створення рахунків PSA**. Ім'я пакетного завдання має містити термін «Створення рахунків».
3. У полі **Тип завдання** виберіть параметр **Немає**. За замовчуванням параметри **Щоденна частота** і **Активовано** мають значення **Так**.
4. Виберіть **Запустити робочий цикл**. У діалоговому вікні **Пошук записів** відображаються три робочі цикли.

    - ProcessRunCaller
    - ProcessRunner
    - UpdateRoleUtilization

5. Виберіть **ProcessRunCaller**, а потім натисніть **Додати**.
6. У подальшому діалоговому вікні натисніть кнопку **ОК**. Робочий цикл **Сплячий режим** супроводжується робочим циклом **Процес**.

    Також можна вибрати **ProcessRunner** у кроці 5. Потім під час вибору **ОК** робочий цикл **Процес** відстежується робочим циклом **Сплячий режим**.

Робочі цикли **ProcessRunCaller** та **ProcessRunner** створюють рахунки. **ProcessRunCaller** викликає **ProcessRunner**. **ProcessRunner** — це робочий цикл, який фактично створює рахунки-фактури. Він проходить через всі позиції сервісного договору, для яких потрібно створити рахунки-фактури, і створює рахунки для цих позицій. Для визначення сервісних робіт за договором, для яких мають бути створені рахунки-фактури, завдання буде дивитися на дату створення рахунка для сервісних робіт за договором. Якщо сервісна робота за договором, що належить до одного сервісного договору, має однакову дату виставлення рахунка-фактури, транзакції об'єднуються в один рахунок-фактуру з двома позиціями рахунка. Якщо для створення рахунків-фактур не буде транзакцій, завдання пропускає створення рахунка-фактури.

Після завершення обробки **ProcessRunner** програма викликає **ProcessRunCaller**, забезпечує час завершення і закривається. Після цього **ProcessRunCaller** запускається таймер на 24 години з указаного періоду завершення. Після завершення таймера **ProcessRunCaller** закривається.

Завдання пакетної обробки для створення рахунків-фактур — це повторюване завдання. Якщо цей пакетний процес виконується багато разів, створюється кілька інсталяцій завдання та виникають помилки. Тому процес пакетної обробки слід запускати лише один раз і перезапускати його, лише якщо він припиняє роботу.

> [!NOTE]
> Пакетне виставлення рахунків в Project Service Automation працює лише для сервісних робіт за договором в рамках проекту, налаштованих за допомогою розкладів виставлення рахунків. Для способу виставлення рахунків за сервісну роботу за договором із фіксованою ціною мають бути налаштовані на основні етапи. Для сервісної роботи за договором в рамках проекту з методом виставлення рахунків за час та матеріали буде потрібно налаштувати розклад виставлення рахунків на основі дати. Відомості про налаштування частоти надсилання рахунків в контексті проекту на основі позиції цінової пропозиції, наведено в розділі [Цінова пропозиція та її позиції](basic-quote-lines.md#invoice-schedule). Те саме стосується сервісної роботи за договором на основі проекту.      
 
### <a name="edit-a-draft-psa-invoice"></a>Редагування чернетки рахунка-фактури в PSA

Під час створення чернетки рахунка-фактури, всі не виставлені транзакції збуту, створені під час затвердження записів часу та витрат, витягуються в рахунок-фактуру. Якщо рахунок-фактура лишається на чернетці, виконайте зазначені нижче дії.

- Видаліть або редагуйте відомості про позицію рахунка.
- Змінюйте та настроюйте кількості та тип рахунка.
- Безпосередньо додавайте час, витрати та платежі як транзакції в рахунку-фактурі. Цю функцію можна використовувати, якщо лінія рахунка-фактури зіставляється з сервісною роботою за договором, яка дає змогу виконувати ці класи транзакцій.

Виберіть **Підтвердити** для підтвердження рахунка-фактури. Дія підтвердження — це одностороння дія. У разі вибору **Підтвердити** система робить рахунок-фактуру лише для читання, і в кожній області рахунка-фактури буде створено фактичні дані збуту з кожної відомості про позицію рахунка. Якщо відомості про позицію рахунка посилаються на невиставлений фактичний збут, система також скасовує фактичні дані про не виставлений збут. (Будь-які відомості позиції рахунка-фактури, створені за допомогою запису часу або витрат, матимуть посилання на не виставлений фактичний збут). Система інтеграції з загальною бухгалтерською системою може використовувати цей зворотній процес для скасування перебігу виконання (WIP) з метою бухгалтерського обліку.

### <a name="correct-a-confirmed-psa-invoice"></a>Виправлення підтвердженого рахунка-фактури в PSA

Підтверджені рахунки-фактури в PSA можна редагувати (виправлено). У разі виправлення підтвердженого рахунка-фактури створюється новий проект з коригувальним рахунком. Оскільки припущення полягає в тому, що потрібно скасувати всі транзакції та кількості з первинного рахунка-фактури, цей коригувальний рахунок-фактура містить усі транзакції з оригінального рахунка-фактури, але всі величини в ньому дорівнюють 0 (нулю).

Якщо будь-які транзакції не потребують корекції, їх можна усунути з чернетки коригувальних рахунків-фактур. Якщо потрібно скасувати або повернути лише часткову кількість, поле **Кількість** можна змінити у відомостях позиції. Якщо відкрити відомості позиції рахунка-фактури, можна побачити вихідну кількість в рахунку. Потім можна змінити поточну кількість в рахунку таким чином, щоб він не був меншим або більшим, ніж кількість в оригіналі рахунку.

Під час підтвердження коригувального рахунка буде скасовано оригінальні рахунки за фактичний збут, а також створюється нові фактичні дані про виставлений у рахунку збут. Якщо кількість було зменшено, то різниця призведе до створення нових фактичних даних про невиставлений у рахунках збут. Наприклад, якщо оригінальні рахунки за збут були на вісім годин, а позиція в коригувальному рахунку має скорочену кількість до шести годин, то програма PSA скасовує початкову позицію в оригінальному рахунку та створює два нові фактичні показники:

- Виставлений в рахунку фактичний обсяг збуту на шість годин.
- Невиставлений в рахунку фактичний обсяг збуту на решту з двох годин. Ця транзакція може бути виставлена в рахунок пізніше або позначена як неоплачувана, залежно від переговорів з клієнтом.


[!INCLUDE[footer-include](../includes/footer-banner.md)]
